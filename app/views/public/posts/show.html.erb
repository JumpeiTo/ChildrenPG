<div class="row">
  <div class="col-4">
    <%= render 'public/playgrounds/playground_show', playground: @playground %>
  </div>
  <div class="col-8">
    <% unless  @post.customer.is_hidden? %>
      <div class="post-group d-flex">
        <div>
          <!--いいねボタン-->
          <div class="favorite-btn">
            <% if customer_signed_in? %>
              <%= render 'public/post_favorites/post_favorites', post: @post %>
            <% end %>
          </div>
          
          <%= image_tag @post.get_post_image(210, 140), class: "img-fluid" %>
        </div>
        <div>
          <h3><%= @post.title %></h3>
          <p><%= simple_format(h(@post.text)) %></p>
          <p><%= @post.rate %>点</p>
          <p>遊べる時間: <span class="badge badge-warning"><%= Post.playtime_methods_i18n[Post.playtime_methods.invert[@post.playtime]] %></span></p>
          <p>関連タグ:
            <% @post.tags.each do |tag| %>
              <span class="badge badge-info"><%= tag.name %></span>
            <% end %>
          </p>
          <p>対象年齢:
            <% @post.target_ages.each do |target_age| %>
              <span class="badge badge-success"><%= target_age.age %></span>
            <% end %>
          </p>
          <p>更新日時: <%= time_ago_in_words(@post.updated_at) %>前</p>
        </div>
      </div>
      <div class="nickname">
        <%= link_to @post_customer_nickname, customers_path(customer_id: @post.customer.id), class: "badge-bg badge badge-pill badge-secondary" %>
      </div>
      <% if @post.customer == current_customer %>
        <%= link_to '編集する',edit_post_path(@post), class: 'btn btn-sm btn-success' %>
        <%= link_to '削除する', post_path(@post), method: :delete, data: { confirm: '本当に削除しますか？' }, class: 'btn btn-sm btn-danger' %>
      <% end %>
      
      <div class="mt-3">
        <% if customer_signed_in? %>
          <div>
            <%= form_with model: [@post, @post_comment] do |f| %>
              <%= f.text_area :comment, rows: '5', placeholder: "コメントをここに" , class: "form-control w-75", style: "height: 70px;" %>
              <%= f.submit "送信する" , class: 'btn btn-sm btn-info' %>
              <%= render "layouts/error", model: f, attribute: :comment %>
            <% end %>
          </div>
        <% end %>
        <div>
          <p>コメント件数：<%=@post_comments.count %></p>
          
          <% @post_comments.each do |post_comment| %>
            <div class="post-comment pl-2">
              <div>
                <%= post_comment.comment %>
              </div>
              <div class="d-flex">
                <div class="nickname mr-2">
                  <%= link_to customers_path(customer_id: post_comment.customer.id) do %>
                    <span class="badge badge-pill badge-secondary">
                      <% if post_comment.customer.is_hidden? %>
                        非公開ユーザー
                      <% elsif post_comment.customer.is_deleted? %>
                        退会済ユーザー
                      <% else %>
                        <%= post_comment.customer.nickname %>
                      <% end %>
                    </span>
                  <% end %>
                </div>
                <div>
                  <%= time_ago_in_words(post_comment.created_at) %>前
                  <% if post_comment.customer == current_customer %>
                    <%= link_to "削除", post_post_comment_path(post_comment.post, post_comment), data: { confirm: '本当に削除しますか？' }, method: :delete, class: 'text-danger' %></br>
                  <% end %>
                </div>
              </div>
            </div>
          <% end %>
          
          <div class="pagination mt-3">
            <%= paginate @post_comments, theme: 'bootstrap-5' %>
          </div>
        </div>
      </div>
    <% else %>
    <h3>非公開ユーザーの投稿です</h3>
    <% end %>
  </div>
</div>
